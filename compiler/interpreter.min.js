const fs=require("fs"),FILE="./main.oba",INF=-1,ANY="ANY";class Func{constructor(e,t,n,i){this.name=e,this.isJS=t,this.method=n,this.params=i}getName=()=>this.name;getParams=()=>this.params;getMethod=()=>this.method;getIsJS=()=>this.isJS}class InterpretingError extends Error{constructor(e){super(e),this.name="InterpretingError"}}class NoOpeningParenthesis extends Error{constructor(e){super(e),this.name="NoOpeningParenthesis"}}let memory={functions:{print:new Func("print",!0,(...e)=>{e.forEach(e=>{console.log(e)})},-1)},variables:[],classes:[]};class Interpreter{constructor(e,t,n){this.code=this.tokenize(e),this.FILE=n,this.mem=t}tokenize=e=>{var t=/\s*(=>|["-+*\][\/\%:\(\)]|[A-Za-z_][A-Za-z0-9_]*|[0-9]*\.?[0-9]+)\s*/g;return e.split(t).filter(function(e){return!e.match(/^\s*$/)})};nextCode=()=>{this.code.shift()};openingParen=()=>"("==this.code[1];variableKwd=e=>["int","arr","str","any"].includes(e);conditionKwd=e=>["if","elif","else"].includes(e);loopKwd=e=>["while","from"].includes(e);retKwd=e=>["ret","res"].includes(e);expressionKwd=e=>["+","-","*","/","^","%"].includes(e);stringKwd=e=>['"',"'","`"].includes(e);funcKwd=e=>{var t=!1;for(let n in this.mem.functions)n==e&&(t=!0);return t};goUntil=(e,t,n)=>{if("}"==t)for(var i=1,r=[],s=e.length,o=0;o<s;o++){var h=e[o];if(h==t?i-=1:"{"==h&&(i+=1),r.push(h),0==i){if("string"==n)return r.join("");if("arr"==n)return r;throw Error("Return type "+n+" does not exist in interpreter.goUnil")}}else if(")"==t)for(var a=1,r=[],s=e.length,o=1;o<s;o++){var h=e[o];if(h==t?a-=1:"("==h?a+=1:r.push(h),0==a){if("string"==n)return r.join("");if("arr"==n)return r;throw Error("Return type "+n+" does not exist in interpreter.goUnil")}}};runFunc=e=>{if(!this.openingParen())throw new NoOpeningParenthesis("Could not find opening parenthesis for calling '"+this.code[0]+"'");var t=this.code[0];this.nextCode();for(var n=this.goUntil(this.code,")","arr"),i=0;i<n.length+1;i++)this.nextCode();this.nextCode();let r=this.mem.functions[t];r.isJS&&(n=n.filter(function(e,t,n){return"`"!=e&&'"'!=e&&"'"!=e}),-1==r.params&&r.method(...n))};runFunc=()=>{if(!this.openingParen())throw new NoOpeningParenthesis("Could not find opening parenthesis for calling '"+this.code[0]+"'");var e=this.code[0];this.nextCode();for(var t=this.goUntil(this.code,")","arr"),n=0;n<t.length+1;n++)this.nextCode();this.nextCode();let i=this.mem.functions[e];i.isJS&&(t=t.filter(function(e,t,n){return"`"!=e&&'"'!=e&&"'"!=e}),-1==i.params&&i.method(...t))};interpret=()=>{if(!this.code.length)throw new InterpretingError("No code in "+FILE);for(;this.code.length>0;){var e=this.code[0]||null;this.variableKwd(e)||this.conditionKwd(e)||this.loopKwd(e)||this.retKwd(e)||this.expressionKwd(e)||this.funcKwd(e)&&this.runFunc()}}}(interpreter=new Interpreter(fs.readFileSync(FILE).toString(),memory)).interpret();